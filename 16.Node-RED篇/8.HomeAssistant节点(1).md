# HomeAssistant节点(1)

## 操作步骤

1. 导入流程样例
2. `enent:all`节点演示
3. `event:state`节点演示
4. `poll state`节点演示

## 参考

| 节点 | 说明 | 输入 | 输出（payload）|
| -- | -- | -- | -- |
| `events:all` | 由HomeAssistant事件触发 | 无 | 事件相关数据 |
| `events:state` | 由实体状态改变事件触发 | 无 | 新的状态值 |
| `poll state` | 定时查询状态 | 无 | 状态值 |

- 流程样例

    ```json
    [{"id":"ef53097d.5af3b8","type":"tab","label":"events:all","disabled":false,"info":""},{"id":"e6574104.b450c","type":"tab","label":"events:state","disabled":false,"info":""},{"id":"1afde359.90f62d","type":"tab","label":"poll state","disabled":false,"info":""},{"id":"69621d87.7af904","type":"server","z":"","name":"HAChina Example","legacy":false,"hassio":false,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open"},{"id":"7c92d0a1.eadbe","type":"server-events","z":"ef53097d.5af3b8","name":"只由xiaomi_aqara.click事件触发","server":"69621d87.7af904","event_type":"xiaomi_aqara.click","x":149,"y":662.0000448226929,"wires":[["260a41b5.88261e"]]},{"id":"80cff72a.fd91d8","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出msg.payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":955.0001029968262,"y":812.9999980926514,"wires":[]},{"id":"260a41b5.88261e","type":"switch","z":"ef53097d.5af3b8","name":"","property":"payload.event.click_type","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":281.9999809265137,"y":833.0000438690186,"wires":[["9e917871.0aa988"],["f0b9e490.544888"],["8c3d79c4.9f6698"]]},{"id":"9e917871.0aa988","type":"change","z":"ef53097d.5af3b8","name":"change节点，设定payload为\"单击\"","rules":[{"t":"set","p":"payload","pt":"msg","to":"单击","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":607,"y":649.9999980926514,"wires":[["80cff72a.fd91d8"]]},{"id":"f0b9e490.544888","type":"change","z":"ef53097d.5af3b8","name":"change节点，设定payload为\"双击\"","rules":[{"t":"set","p":"payload","pt":"msg","to":"双击","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":616.0000152587891,"y":798.0000591278076,"wires":[["80cff72a.fd91d8"]]},{"id":"8c3d79c4.9f6698","type":"change","z":"ef53097d.5af3b8","name":"change节点，设定payload为\"长按\"","rules":[{"t":"set","p":"payload","pt":"msg","to":"长按","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":561.9999923706055,"y":932.9999828338623,"wires":[["80cff72a.fd91d8"]]},{"id":"45261274.003c6c","type":"server-events","z":"ef53097d.5af3b8","name":"所有事件","server":"69621d87.7af904","event_type":"","x":139.88280868530273,"y":245.58205223083496,"wires":[["aa8164c7.8a5668","fa25242b.0a2598","680e2ad.42936d4","9f10fec7.cb7b2","8177868a.07dac8"]]},{"id":"aa8164c7.8a5668","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出msg.payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":542.8984985351562,"y":130.67971801757812,"wires":[]},{"id":"fa25242b.0a2598","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出msg.topic","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"topic","x":524.0195465087891,"y":210.00391101837158,"wires":[]},{"id":"680e2ad.42936d4","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出msg.event_type","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"event_type","x":544.0195770263672,"y":318.00391960144043,"wires":[]},{"id":"9f10fec7.cb7b2","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出msg.payload.event.entity_id","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.event.entity_id","x":575.0195503234863,"y":417.00390434265137,"wires":[]},{"id":"8177868a.07dac8","type":"debug","z":"ef53097d.5af3b8","name":"dubug输出all","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":528.0195732116699,"y":45.99999809265137,"wires":[]},{"id":"401dfb4b.7bc1a4","type":"server-state-changed","z":"e6574104.b450c","name":"所有实体状态改变事件","server":"69621d87.7af904","entityidfilter":".*","entityidfiltertype":"regex","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"x":220,"y":300,"wires":[["fa7bd4bc.372168"]]},{"id":"fa7bd4bc.372168","type":"debug","z":"e6574104.b450c","name":"debug输出payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":710,"y":240,"wires":[]},{"id":"90b025c1.8bede8","type":"server-state-changed","z":"e6574104.b450c","name":"判断某实体新的状态","server":"69621d87.7af904","entityidfilter":"sensor.temperature_158d00019f8b1f","entityidfiltertype":"substring","outputinitially":false,"state_type":"num","haltifstate":"30","halt_if_type":"num","halt_if_compare":"gt","outputs":2,"x":230,"y":620,"wires":[["9b145a75.f7f578"],["cb76e7db.c38a68"]]},{"id":"9b145a75.f7f578","type":"debug","z":"e6574104.b450c","name":"debug输出payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":710,"y":540,"wires":[]},{"id":"cb76e7db.c38a68","type":"debug","z":"e6574104.b450c","name":"debug输出payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":670,"y":740,"wires":[]},{"id":"c689c009.ee1c3","type":"poll-state","z":"1afde359.90f62d","name":"每5秒轮询状态","server":"69621d87.7af904","updateinterval":"5","outputinitially":false,"outputonchanged":false,"entity_id":"sensor.temperature_158d00019f8b1f","state_type":"str","halt_if":"30","halt_if_type":"num","halt_if_compare":"gt","outputs":2,"x":260,"y":440,"wires":[["bc1c32ab.882fc"],["cafd670.2dbf498"]]},{"id":"bc1c32ab.882fc","type":"debug","z":"1afde359.90f62d","name":"debug输出payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":700,"y":300,"wires":[]},{"id":"cafd670.2dbf498","type":"debug","z":"1afde359.90f62d","name":"debug输出payload","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":690,"y":500,"wires":[]}]
    ```
