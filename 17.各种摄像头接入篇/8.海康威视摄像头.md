# 海康威视摄像头

## 图像的接入

1. 登录海康威视摄像头的配置页面，默认的地址为192.168.1.64，首次使用需要激活设备，创建用户名与密码
2. 依次进入`配置`——>`网络`——>`高级配置`——>`集成协议`
3. 勾选`启用ONVIF`，同时点击`添加`新用户，输入用户名和密码，用户类型可以选择`管理员`
4. 进入HomeAssistant中的`集成`处，选择ONVIF，输入用户名密码即可接入

在上述操作过程中，关于海康威视的配置部分，都要注意配置完毕后需要点击`保存`
 
视频中摄像头型号为`DS-2CD3526`，只要是支持ONVIF的海康威视摄像头都可以用这种方法接入
 
## 传感器的接入

1. 配置文件中添加以下内容

  ```yaml
  binary_sensor:
    - platform: hikvision

      #摄像头的IP地址
      host: 192.168.1.64 

      #摄像头的网页登录的用户名与密码
      username: admin
      password: test1234

  ```

2. 进入海康威视的配置页面，依次进入`配置`——>`事件`——>`普通事件`，选择需要配置的事件信息，如：`移动侦测`，需要勾选`启用移动侦测`，并且在`联防方式`中勾选`上传中心`

3. 在部分配置中，有单独`绘制区域`的选项，点击后在图像中用鼠标绘制即可，详细操作可见视频

4. 配置完毕后，重启HA，勾选了`上传中心`的事件都会以一个二进制传感器的形式自动接入HA中

视频中摄像头型号为`DS-2CD3526`，支持事件类型为普通事件与smart事件

## 比较有用的自动化触发事件

1. 借助普通事件中的移动侦测功能来开启灯光或者其他设备
2. 借助smart事件中的离开区域来关闭灯光或者其他设备

对于自动化来说，这里只是给出一个简单的例子，实际使用中情况会更加的复杂，需要大家自己判断：

例如加入延时系统，可以使用在一些时间不敏感的自动化，例如空调的自动调节系统，例如检测到人离开区域10分钟内，区域内没有任何的活动，关闭空调，防止人短暂离开后又回来

又例如多人自动灯光的检测，不希望一个人离开就关闭灯光，则和上述一样，持续一段时间的检测没有移动再执行关灯
